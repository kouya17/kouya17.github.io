---
title: "全国規模の感染シミュレーションと結果の可視化をしてみる"
date: 2020-05-20T22:37:30+09:00
tags: ["matplotlib", "python", "simulation"]
cover:
  image: "media/photos/20/05/20/053.png"
---

先日、[都道府県間通勤・通学を考慮した感染症流行のシミュレーション](https://kouya17.com/posts/25/)を行った。  
この時は関東のみのシミュレーションだったが、今回は全国規模の感染シミュレーションを実施してみる。

なお、この記事ではモデルに関する説明は特に記載しないため、モデルの詳細は以下過去の記事を参照していただきたい。

[感染症数理モデルについて触りの部分だけ学ぶ \| kouya17\.com](https://kouya17.com/posts/24/)  
[都道府県間通勤・通学を考慮したパンデミックシミュレーションもどき \| kouya17\.com](https://kouya17.com/posts/25/)

<small>※本シミュレーションや上記リンク先のシミュレーションは、実測値等には全く基づいていないため、完全に空想上のシミュレーションになります。  
本シミュレーションの結果が実情を反映していたり、今後の予測を示していたりはしません。</small>

## 利用するデータ

シミュレーションを全国規模に拡張するには各都道府県の人口のデータと、各都道府県間の通勤・通学者人数のデータが必要になる。  
これらのデータは総務省統計局「平成27年国勢調査結果」[^1]を利用した。

## パラメータ、初期状態について

SEIRモデルに置ける各パラメータは今回以下のように設定する。  
基本再生産数 \\(R_0\\) : 2.0  
平均潜伏期間 \\(l\\) : 5日  
平均発症期間 \\(i\\) : 14日

初期状態はAM0時に、東京都に1人の感染者がいる状態とする。

今回は都道府県間通勤・通学について

- 通勤・通学者なし
- 通勤・通学者あり、通勤・通学者数は特に加工しない
- 通勤・通学者あり、通勤・通学者数は元データの20%にする
- 通勤・通学者あり、通勤・通学者数は元データの0.01%にする

の4パターン、計算を実施して、通勤・通学者数が与える影響を調べてみる。

また、[前回](https://kouya17.com/posts/25/)のシミュレーションでは休日の概念を設けていなかった。  
働きっぱなしは可哀想なので、土日は休みにし、通勤・通学はしないものとする。  
ただし、祝日や土日以外の長期休暇は考慮しない。

## 結果及び可視化

今回はデータが少し多くなってくるので、可視化の方法も工夫する必要がある。  
[japanmap](https://pypi.org/project/japanmap/)という、日本地図を都道府県別に色分けできるライブラリがあるようなので、これを利用させていただく。

### 発症者比率の可視化

各都道府県について、人口に占める発症者の比率(\\(\frac{I}{S+E+I+R}\\))を可視化する。  
発症者の比率を赤色の濃淡で表したアニメーションを以下に示す。

#### 通勤・通学者なしの場合

![](/media/gif/20200520/commute00.gif)

都道府県の人の移動が発生しないため、東京でしか流行しない。

#### 通勤・通学者ありの場合

![](/media/gif/20200520/commute10.gif)

日本全国に感染が広がる。  
ただし、感染のピークは東京から遠い都道府県ほど遅くなる。

#### 通勤・通学者あり、ただし人数20%の場合

![](/media/gif/20200520/commute02.gif)

人数を絞る前の結果とほぼ変わらないように見える。

#### 通勤・通学者あり、ただし人数0.01%の場合

![](/media/gif/20200520/commute00001.gif)

人数を思いっきり絞ってみると、人数を絞る前と比べて感染が広がるスピードが遅いように見える。

### 1000日目時点での累計感染者数の可視化

それぞれの条件で1000日目時点での累計感染者数(\\(E+I+R\\))をグラフ化する。  
横軸を各都道府県、縦軸を累計感染者数にした棒グラフを以下に示す。

![](/media/markdownx/942fc5b3-49c3-4e59-a76f-25b4a9063119.png)

通勤・通学における各条件の結果をそれぞれ色を変えて並べている。  
累計感染者数に関しては、通勤・通学者数を絞っても変化はない。

## ソースコード

今回使用したコードは以下に置いてある。  
ただし、全然整理できていない…。

<iframe class="hatenablogcard" style="width:100%;height:155px;margin:15px 0;max-width:680px;" title="kouya17/seir_commute_model: SEIRモデルに対し、通勤・通学の影響を考慮したシミュレーションモデル" src="https://hatenablog-parts.com/embed?url=https://github.com/kouya17/seir_commute_model" frameborder="0" scrolling="no"></iframe>

[^1]: [統計局ホームページ/平成27年国勢調査/調査の結果](https://www.stat.go.jp/data/kokusei/2015/kekka.html)